<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dino Runner – Spiel</title>
<style>
  body { margin:0; padding:0; overflow:hidden; font-family:sans-serif; background:#f0f0f0; }
  canvas { display:block; background:#fff; margin:0 auto; }
  #scoreTable {
    position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
    background: rgba(255,255,255,0.9); padding:10px; border-radius:5px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3); font-size:14px;
  }
  #nicknameInput {
    margin-top:5px; width:100px;
  }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="scoreTable">
  <div>Top 5 Highscores:</div>
  <ol id="highscores"></ol>
  <input type="text" id="nicknameInput" placeholder="Nickname">
  <button onclick="saveScore()">Speichern</button>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight * 0.6; // 60% Höhe für Spiel, Rest für Score
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// Dino
const dino = { x:50, y:0, width:50, height:50, yVel:0, gravity:0.7, jump:15, onGround:false };

// Hindernisse
let obstacles = [];
let spawnTimer = 0;

// Score
let score = 0;
let gameSpeed = 5;

// Highscores
let highScores = JSON.parse(localStorage.getItem('dinoHighscores')||'[]');
function updateHighscoreList() {
  const ol = document.getElementById('highscores');
  ol.innerHTML = '';
  highScores.slice(0,5).forEach(s => {
    const li = document.createElement('li');
    li.textContent = `${s.name}: ${Math.floor(s.score)}`;
    ol.appendChild(li);
  });
}
updateHighscoreList();

// Input
document.addEventListener('keydown', e => { if(e.code==='Space') jump(); });
canvas.addEventListener('touchstart', jump);

function jump() {
  if(dino.onGround){
    dino.yVel = -dino.jump;
    dino.onGround = false;
  }
}

function spawnObstacle() {
  const height = 20 + Math.random()*50;
  obstacles.push({
    x: canvas.width,
    y: canvas.height - height,
    width: 20 + Math.random()*30,
    height: height
  });
}

function saveScore() {
  const name = document.getElementById('nicknameInput').value || 'Spieler';
  highScores.push({name, score});
  highScores.sort((a,b)=>b.score-a.score);
  localStorage.setItem('dinoHighscores', JSON.stringify(highScores));
  updateHighscoreList();
}

// Game Loop
function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Dino
  dino.y += dino.yVel;
  dino.yVel += dino.gravity;
  if(dino.y + dino.height > canvas.height){
    dino.y = canvas.height - dino.height;
    dino.yVel = 0;
    dino.onGround = true;
  }
  ctx.fillStyle = '#00b';
  ctx.fillRect(dino.x, dino.y, dino.width, dino.height);

  // Obstacles
  spawnTimer--;
  if(spawnTimer<=0){
    spawnObstacle();
    spawnTimer = 60 + Math.random()*60;
  }

  obstacles.forEach((ob,i)=>{
    ob.x -= gameSpeed;
    ctx.fillStyle = '#b00';
    ctx.fillRect(ob.x, ob.y, ob.width, ob.height);

    // Kollisionsprüfung
    if(dino.x < ob.x+ob.width && dino.x+dino.width > ob.x &&
       dino.y < ob.y+ob.height && dino.y+dino.height > ob.y){
         alert('Game Over! Score: '+Math.floor(score));
         score=0; obstacles=[]; spawnTimer=0; dino.y = canvas.height - dino.height; dino.yVel=0; dino.onGround=true;
    }

    if(ob.x+ob.width<0) obstacles.splice(i,1);
  });

  // Score
  score += 0.1;
  document.getElementById('nicknameInput').placeholder = 'Score: '+Math.floor(score);

  // Geschwindigkeit erhöhen
  gameSpeed = 5 + Math.floor(score/10)*0.5;

  requestAnimationFrame(update);
}

update();
</script>

</body>
</html>
