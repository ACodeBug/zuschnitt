<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventur Druck</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.3.1/docx.min.js"></script>
</head>
<body class="p-4 bg-light">

<div class="container">
  <h2 class="mb-3">Inventur Druck Generator</h2>
  
  <div class="mb-3">
    <label>Feld-Nr:</label>
    <input type="number" id="feld" class="form-control" value="4009">
  </div>
  <div class="mb-3">
    <label>Regal von:</label>
    <input type="number" id="von" class="form-control" value="1">
  </div>
  <div class="mb-3">
    <label>Regal bis:</label>
    <input type="number" id="bis" class="form-control" value="5">
  </div>
  <div class="mb-3">
    <label>Jahr:</label>
    <input type="number" id="jahr" class="form-control" value="2025">
  </div>

  <button class="btn btn-primary me-2" onclick="generatePDF()">📄 PDF erzeugen</button>
  <button class="btn btn-success" onclick="generateWord()">📝 Word erzeugen</button>
</div>

<script>
// 🟦 PDF Generator – platziert Text genau auf der Seite
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit:'pt', format:'a4' });
  const pageWidth = doc.internal.pageSize.width;
  const pageHeight = doc.internal.pageSize.height;

  const feld = document.getElementById('feld').value || '-';
  const von = parseInt(document.getElementById('von').value) || 1;
  const bis = parseInt(document.getElementById('bis').value) || 15;
  const jahr = document.getElementById('jahr').value || new Date().getFullYear();

  doc.setFont("Helvetica", "normal");
  doc.setFontSize(130);

  for(let r=von; r<=bis; r++){
    const oben = `${feld}/${r}`;
    const mitte = `${jahr}`;

    // Zentrierung
    const obenBreite = doc.getTextWidth(oben);
    const mitteBreite = doc.getTextWidth(mitte);
    doc.text(oben, (pageWidth-obenBreite)/2, pageHeight/2 - 100);
    doc.text(mitte, (pageWidth-mitteBreite)/2, pageHeight/2 + 50);

    if(r < bis) doc.addPage(); // neue Seite
  }

  doc.save('Inventur.pdf');
}

// 🟩 Word Generator – neue Seite pro Druck, Text zentriert
async function generateWord(){
  const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;

  const feld = document.getElementById('feld').value || '-';
  const von = parseInt(document.getElementById('von').value) || 1;
  const bis = parseInt(document.getElementById('bis').value) || 15;
  const jahr = document.getElementById('jahr').value || new Date().getFullYear();

  const sections = [];

  for(let r=von; r<=bis; r++){
    sections.push({
      properties: {},
      children: [
        new Paragraph({
          alignment: AlignmentType.CENTER,
          spacing: { after: 400 },
          children: [ new TextRun({ text: `${feld}/${r}`, font: "Calibri", size: 130*2 }) ]
        }),
        new Paragraph({
          alignment: AlignmentType.CENTER,
          children: [ new TextRun({ text: `${jahr}`, font: "Calibri", size: 130*2 }) ]
        })
      ]
    });
  }

  const doc = new Document({ sections });
  const blob = await Packer.toBlob(doc);

  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = "Inventur.docx";
  document.body.appendChild(link);
  link.click();
  link.remove();
}
</script>

</body>
</html>
